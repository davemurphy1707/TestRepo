---
title: "Shiny_1"
output: html_document
date: "`r Sys.Date()`"
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(tidyverse)
```

```{r}
DIG.df <- read_csv("DIG.csv", show_col_types = FALSE)
head(DIG.df)
dig.df <- DIG.df %>% select(ID, TRTMT, AGE, SEX, BMI, KLEVEL, CREAT, DIABP, SYSBP, HYPERTEN, CVD, WHF, DIG, HOSP, HOSPDAYS, DEATH, DEATHDAY)
dig.df <- dig.df %>% mutate(ID = as.factor(ID), 
                            TRTMT = as.factor(TRTMT),
                            AGE = as.numeric(AGE),
                            SEX = as.factor(SEX),
                            BMI = as.numeric(BMI),
                            KLEVEL = as.numeric(KLEVEL),
                            CREAT = as.numeric(CREAT),
                            DIABP = as.numeric(DIABP),
                            SYSBP = as.numeric(SYSBP),
                            HYPERTEN = as.factor(HYPERTEN),
                            CVD = as.factor(CVD),
                            WHF = as.factor(WHF),
                            DIG = as.factor(DIG),
                            HOSP = as.factor(HOSP),
                            HOSPDAYS = as.numeric(HOSPDAYS),
                            DEATH = as.factor(DEATH),
                            DEATHDAY = as.numeric(DEATHDAY)) %>%
  filter(!is.na(HYPERTEN)) %>%
  filter(!is.na(KLEVEL))#filter out na values of hyperten for Q 11
```


```{r eruptions, echo=FALSE}
ui <- fluidPage(
  titlePanel("DIG Scatter Plot"),
  sidebarLayout(
    sidebarPanel(
      selectInput(
        inputId = "Sex",
        label = "Select the Sex:",
        choices = levels(dig.df$SEX) # Dynamically load SEX levels from the dataset
      )
    ),
    mainPanel(
      plotOutput("distPlot") # Placeholder for the scatter plot
    )
  )
)

server <- function(input, output, session) {
  output$distPlot <- renderPlot({
    dig.df %>% 
      filter(SEX == input$Sex) %>% 
      ggplot(aes(x = AGE, y = HOSPDAYS, color = SEX)) +
      geom_point(alpha = 0.6, size = 3) +
      labs(
        title = "Scatter Plot of Age and HOSPDAYS by Sex",
        x = "Age",
        y = "Hospital Days",
        color = "Sex"
      ) +
      theme_minimal()
  })
}

shinyApp(ui = ui, server = server)


```

## Embedded Application

It's also possible to embed an entire Shiny application within an R Markdown document using the `shinyAppDir` function. This example embeds a Shiny application located in another directory:

```{r tabsets, echo=FALSE}
shinyAppDir(
  system.file("examples/06_tabsets", package = "shiny"),
  options = list(
    width = "100%", height = 550
  )
)
```

Note the use of the `height` parameter to determine how much vertical space the embedded application should occupy.

You can also use the `shinyApp` function to define an application inline rather then in an external directory.

In all of R code chunks above the `echo = FALSE` attribute is used. This is to prevent the R code within the chunk from rendering in the document alongside the Shiny components.



